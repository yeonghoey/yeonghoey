<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120656861-1"></script>
  <script>
   window.dataLayer = window.dataLayer || [];
   function gtag(){dataLayer.push(arguments);}
   gtag('js', new Date());
   gtag('config', 'UA-120656861-1');
  </script>

  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />


  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#00aba9">
  <meta name="theme-color" content="#ffffff">

  <title>AWS DynamoDB</title>

  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>

  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <link rel="stylesheet" href="/_css/content.css" />


  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->

  <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed|Roboto+Mono" rel="stylesheet">
</head>
<body>
<nav class="menu">
  <ol class="breadcrumb">
    <li><a href="/" >Home</a></li>
    <li>dynamodb</li>
  </ol>
  <ul class="children">
    <li><a href="./boto3">boto3</a></li>
  </ul>
</nav>

<article>
<header>
<h1 class="title">AWS DynamoDB</h1>
</header>

<nav class="toc">
<h2>Table of Contents</h2>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#api">API</a></li>
<li><a href="#partitions">Partitions</a></li>
<li><a href="#secondary-indexes">Secondary Indexes</a><ul>
<li><a href="#gsi">GSI</a><ul>
<li><a href="#attribute-projections">Attribute Projections</a></li>
</ul></li>
<li><a href="#lsi">LSI</a></li>
</ul></li>
<li><a href="#operations">Operations</a></li>
<li><a href="#working-with-items">Working with Items</a></li>
<li><a href="#attributes">Attributes</a></li>
<li><a href="#consistency">Consistency</a></li>
<li><a href="#capacity-throughput">Capacity &amp; Throughput</a></li>
<li><a href="#backup-restore">Backup &amp; Restore</a></li>
<li><a href="#pricing">Pricing</a></li>
<li><a href="#access-and-permissions-based-on-iam">Access and Permissions Based on IAM</a></li>
<li><a href="#limits">Limits</a></li>
<li><a href="#best-practices">Best Practices</a></li>
</ul>
</nav>

<h1 id="overview">Overview</h1>
<p><img src="https://media.yeonghoey.com/dynamodb/_img/screenshot_2017-04-21_12-12-59.png" /></p>
<ul>
<li>Tables like <code>People</code>, <code>Music</code></li>
<li>Items like each <code>{..}</code> in Tables</li>
<li>Attributes like <code>PersonID</code>, <code>LastName</code>, <code>Artist</code>, <code>Price</code>, and so on</li>
<li>Primary keys are bolded attributes like <code>PersonID</code>, <code>(Artist, SongTitle)</code></li>
<li>Primary key can be either a single <code>partition key</code> or a pair of <code>partition key</code> and <code>sort key</code></li>
<li>Primary key attribute must be a scalar(like <code>string</code>, <code>number</code>, etc)</li>
<li>Secondary Indexes like <code>GenreAlbumTitle</code></li>
<li>Secondary Indexes can be either <code>Global</code> or <code>Local</code></li>
<li><code>Global</code> consists of a <code>partition key</code> and a <code>sort key</code> that can be different from those on the table</li>
<li><code>Local</code> has the same <code>partition key</code> as the table but a different <code>sort key</code></li>
</ul>
<div class="REFERENCES drawer">
<ul>
<li><a href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.CoreComponents.html" class="uri">http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.CoreComponents.html</a></li>
</ul>
</div>
<h1 id="api">API</h1>
<pre class="example"><code>CreateTable
DescribeTable
ListTables
UpdateTable
DeleteTable
</code></pre>
<pre class="example"><code>PutItem
BatchWriteItem (up to 25 items)
GetItem        (uses primary key)
BatchGetItem   (up to 100 items)
Query
Scan
UpdateItem
DeleteItem
BatchWriteItem
</code></pre>
<pre class="example"><code>ListStreams
DescribeStream
GetShardIterator
GetRecords
</code></pre>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.API.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.API.html</a></li>
</ul>
</div>
<h1 id="partitions">Partitions</h1>
<p><img src="https://media.yeonghoey.com/dynamodb/_img/screenshot_2018-03-11_14-55-25.png" /></p>
<ul>
<li>DynamoDB calculates the hash value of <code>Dog</code>, yielding the partition in which these items are stored.</li>
<li>DynamoDB then scans the sort key attribute values until it finds <code>Fido</code>.</li>
</ul>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.Partitions.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.Partitions.html</a></li>
</ul>
</div>
<h1 id="secondary-indexes">Secondary Indexes</h1>
<ul>
<li>This requires separated capacity management from those of its base table</li>
</ul>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/SecondaryIndexes.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/SecondaryIndexes.html</a></li>
</ul>
</div>
<h2 id="gsi">GSI</h2>
<ul>
<li>A global secondary index is considered &quot;global&quot; because queries on the index can span all of the data in the base table, across all partitions.</li>
<li>When you create an index, <strong>you specify which attributes will be copied, or projected</strong>, from the base table to the index.</li>
</ul>
<p><img src="https://media.yeonghoey.com/dynamodb/_img/screenshot_2018-03-10_20-34-48.png" /></p>
<ul>
<li>DynamoDB maintains indexes automatically.</li>
<li>In this case, <code>Artist</code> and <code>SongTitle</code> are projected attributes</li>
<li>Global secondary indexes are composed of partitions.</li>
</ul>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GSI.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GSI.html</a></li>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GuidelinesForGSI.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GuidelinesForGSI.html</a></li>
</ul>
</div>
<h3 id="attribute-projections">Attribute Projections</h3>
<ul>
<li>A projection is the set of attributes that is copied from a table into a secondary index.</li>
<li>There are three options for attribute projections:
<ul>
<li><code>KEYS_ONLY</code></li>
<li><code>INCLUDE</code></li>
<li><code>ALL</code></li>
</ul></li>
</ul>
<h2 id="lsi">LSI</h2>
<ul>
<li>A local secondary index is &quot;local&quot; in the sense that every partition of a local secondary index is scoped to a base table partition that has the same partition key value.</li>
</ul>
<h1 id="operations">Operations</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="er">&quot;GetItem&quot;</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="fu">{</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">    <span class="er">TableName</span><span class="fu">:</span> <span class="st">&quot;Music&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">    <span class="er">Key</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">        <span class="dt">&quot;Artist&quot;</span><span class="fu">:</span> <span class="st">&quot;No One You Know&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">        <span class="dt">&quot;SongTitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Call Me Today&quot;</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">    <span class="fu">}</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="fu">}</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="er">&quot;Query&quot;</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="fu">{</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12">    <span class="er">TableName</span><span class="fu">:</span> <span class="st">&quot;Music&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13">    <span class="er">KeyConditionExpression</span><span class="fu">:</span> <span class="st">&quot;Artist = :a and SongTitle = :t&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14">    <span class="er">ExpressionAttributeValues</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15">        <span class="dt">&quot;:a&quot;</span><span class="fu">:</span> <span class="st">&quot;No One You Know&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16">        <span class="dt">&quot;:t&quot;</span><span class="fu">:</span> <span class="st">&quot;Call Me Today&quot;</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17">    <span class="fu">}</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="fu">}</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="er">&quot;Query</span> <span class="er">using</span> <span class="er">Index&quot;</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="fu">{</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22">    <span class="er">TableName</span><span class="fu">:</span> <span class="st">&quot;Music&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23">    <span class="er">IndexName</span><span class="fu">:</span> <span class="st">&quot;GenreAndPriceIndex&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24">    <span class="er">KeyConditionExpression</span><span class="fu">:</span> <span class="st">&quot;Genre = :genre&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25">    <span class="er">ExpressionAttributeValues</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26">        <span class="dt">&quot;:genre&quot;</span><span class="fu">:</span> <span class="st">&quot;Rock&quot;</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27">    <span class="fu">},</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="fu">}</span><span class="er">;</span></a></code></pre></div>
<h1 id="working-with-items">Working with Items</h1>
<dl>
<dt><code>#a</code></dt>
<dd>an expression attribute name, mostly used with projection expressions
</dd>
<dt><code>:a</code></dt>
<dd>an expression attribute value, mostly used with update expressions
</dd>
</dl>
<p>Preventing Overwrites by using condition-expression</p>
<pre class="shell"><code>aws dynamodb put-item \
    --table-name ProductCatalog \
    --item file://item.json \
    --condition-expression &quot;attribute_not_exists(Id)&quot;
</code></pre>
<p>References for operators like <code>attribute_not_exists</code> are <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Expressions.OperatorsAndFunctions.html">here</a>.</p>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Expressions.ConditionExpressions.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Expressions.ConditionExpressions.html</a></li>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/WorkingWithItems.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/WorkingWithItems.html</a></li>
</ul>
</div>
<h1 id="attributes">Attributes</h1>
<ul>
<li>Also, the following characters have special meaning in DynamoDB: <code>#</code> (hash) and <code>:</code> (colon).</li>
<li>Although DynamoDB allows you to use these reserved words and special characters for names, we recommend that you avoid</li>
</ul>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_AttributeDefinition.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_AttributeDefinition.html</a></li>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/ReservedWords.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/ReservedWords.html</a></li>
</ul>
</div>
<h1 id="consistency">Consistency</h1>
<ul>
<li>DynamoDB supports eventually consistent and strongly consistent reads.</li>
</ul>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.ReadConsistency.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.ReadConsistency.html</a></li>
</ul>
</div>
<h1 id="capacity-throughput">Capacity &amp; Throughput</h1>
<ul>
<li>Read unit is 4 KB per second (twice when using eventually consistent reads, not strongly consistent reads)</li>
<li>Write unit is 1 KB per second</li>
<li>Each unit performs one request per second(if the operation requires the size less than the unit size) . In other words, with 5 read capacity unit, you can handle 5 requests per second.</li>
<li>Options for determining throughput: Auto scaling, Provisioned, Reserved</li>
</ul>
<blockquote>
<p>Queryâ€”reads multiple items that have the same partition key value. <strong>All of the items returned are treated as a single read operation</strong>, where DynamoDB computes the total size of all items and then rounds up to the next 4 KB boundary. For example, suppose your query returns 10 items whose combined size is 40.8 KB. DynamoDB rounds the item size for the operation to 44 KB. If a query returns 1500 items of 64 bytes each, the cumulative size is 96 KB.</p>
</blockquote>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.ProvisionedThroughput.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.ProvisionedThroughput.html</a></li>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/ProvisionedThroughput.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/ProvisionedThroughput.html</a></li>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/CapacityUnitCalculations.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/CapacityUnitCalculations.html</a></li>
</ul>
</div>
<h1 id="backup-restore">Backup &amp; Restore</h1>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/BackupRestore.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/BackupRestore.html</a></li>
</ul>
</div>
<h1 id="pricing">Pricing</h1>
<ul>
<li>Based on WCU(Write Capacity Unit), RCU(Read Capacity Unit), and Storage</li>
</ul>
<h1 id="access-and-permissions-based-on-iam">Access and Permissions Based on IAM</h1>
<blockquote>
<p>If you use <code>dynamodb:Attributes</code>, you must specify the names of all of the primary key and index key attributes for the table and any secondary indexes that are listed the in the policy. Otherwise, DynamoDB can't use these key attributes to perform the requested action.</p>
</blockquote>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/specifying-conditions.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/specifying-conditions.html</a></li>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/api-permissions-reference.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/api-permissions-reference.html</a></li>
</ul>
</div>
<h1 id="limits">Limits</h1>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Limits.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Limits.html</a></li>
</ul>
</div>
<h1 id="best-practices">Best Practices</h1>
<div class="REFERENCES drawer">
<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/BestPractices.html" class="uri">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/BestPractices.html</a></li>
</ul>
</div>
</article>

</body>
</html>
